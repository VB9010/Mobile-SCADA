<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>üè≠ Industrial SCADA/DCS System - Mobile</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary-blue: #1e3a8a;
            --secondary-blue: #3b82f6;
            --success-green: #16a34a;
            --warning-yellow: #fbbf24;
            --danger-red: #dc2626;
            --gray-dark: #374151;
            --gray-light: #f3f4f6;
            --scada-bg: #0f172a;
            --panel-bg: #1e293b;
            --border-color: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --alarm-red: #ff0000;
            --alarm-yellow: #ffff00;
            --status-green: #00ff00;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: var(--scada-bg);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
            touch-action: manipulation;
        }

        /* Mobile-first header */
        .scada-header {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .scada-title {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .company-logo {
            width: 32px;
            height: 32px;
            background: var(--success-green);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
            flex-shrink: 0;
        }

        .system-info h1 {
            font-size: 14px;
            color: white;
            margin: 0;
            line-height: 1.2;
        }

        .system-info p {
            font-size: 9px;
            color: rgba(255,255,255,0.8);
            margin: 0;
            line-height: 1.2;
            display: none; /* Hide on very small screens */
        }

        .header-controls {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-shrink: 0;
        }

        .alarm-indicator {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--success-green);
            color: white;
            min-width: 60px;
            text-align: center;
        }

        .alarm-indicator.warning {
            background: var(--warning-yellow);
            color: black;
            animation: blink 1s infinite;
        }

        .alarm-indicator.critical {
            background: var(--danger-red);
            color: white;
            animation: blink 0.5s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .system-time {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: var(--status-green);
            font-size: 10px;
        }

        /* Mobile navigation tabs */
        .mobile-nav {
            background: var(--panel-bg);
            display: flex;
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .nav-tab {
            flex: 1;
            min-width: 80px;
            padding: 12px 8px;
            background: transparent;
            color: var(--text-secondary);
            border: none;
            cursor: pointer;
            font-size: 11px;
            text-align: center;
            transition: all 0.3s ease;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
        }

        .nav-tab.active {
            background: rgba(59, 130, 246, 0.2);
            color: var(--text-primary);
            border-bottom-color: var(--secondary-blue);
        }

        .nav-tab:active {
            background: rgba(59, 130, 246, 0.3);
        }

        /* Mobile container - single column stack */
        .mobile-container {
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 100px);
        }

        .view-section {
            display: none;
            padding: 10px;
            background: var(--scada-bg);
        }

        .view-section.active {
            display: block;
        }

        /* Process Overview - Mobile optimized */
        .process-overview-mobile {
            position: relative;
            height: 60vh;
            background: radial-gradient(circle at 30% 20%, rgba(59, 130, 246, 0.1), transparent 50%),
                        radial-gradient(circle at 70% 80%, rgba(16, 185, 129, 0.1), transparent 50%),
                        var(--scada-bg);
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        /* P&ID Style Equipment - exactly matching the image */
        
        .reactor-pid {
            position: absolute;
            width: 120px;
            height: 120px;
            background: #4A5FE7;
            border: 3px solid #3A4ECC;
            border-radius: 50%;
            left: 18%;
            top: 25%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            touch-action: manipulation;
            z-index: 2;
        }

        .heat-exchanger-pid {
            position: absolute;
            width: 110px;
            height: 70px;
            background: #22C55E;
            border: 3px solid #16A34A;
            border-radius: 8px;
            right: 20%;
            top: 15%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            touch-action: manipulation;
            z-index: 2;
        }

        .valve-pid {
            position: absolute;
            width: 40px;
            height: 40px;
            background: #8B5CF6;
            border: 3px solid #7C3AED;
            transform: rotate(45deg);
            right: 28%;
            top: 25%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            touch-action: manipulation;
            z-index: 2;
        }

        .pump-pid {
            position: absolute;
            width: 80px;
            height: 80px;
            background: #F97316;
            border: 3px solid #EA580C;
            border-radius: 50%;
            left: 5%;
            bottom: 20%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            touch-action: manipulation;
            z-index: 2;
        }

        .tank-pid {
            position: absolute;
            width: 85px;
            height: 100px;
            background: #6B7280;
            border: 3px solid #4B5563;
            border-radius: 8px 8px 25px 25px;
            right: 8%;
            top: 40%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            touch-action: manipulation;
            z-index: 2;
        }

        /* Sensors - small green circles exactly like the image */
        .sensor-pid {
            position: absolute;
            width: 28px;
            height: 28px;
            background: #22C55E;
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            touch-action: manipulation;
            z-index: 3;
        }

        .sensor-icon-pid {
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .sensor-tag-pid {
            position: absolute;
            top: -28px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: bold;
            white-space: nowrap;
            pointer-events: none;
            border: 1px solid #22C55E;
        }

        /* Process displays - green bordered black rectangles exactly like the image */
        .process-display-pid {
            position: absolute;
            background: #000000;
            border: 2px solid #22C55E;
            border-radius: 4px;
            padding: 6px 10px;
            z-index: 3;
        }

        .display-value {
            color: #22C55E;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            font-weight: bold;
            margin: 0;
            line-height: 1;
        }

        /* Equipment hover effects */
        .reactor-pid:hover, .heat-exchanger-pid:hover, .valve-pid:hover, 
        .pump-pid:hover, .tank-pid:hover {
            transform: scale(1.02);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .sensor-pid:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(34, 197, 94, 0.5);
        }

        /* Mobile responsive adjustments */
        @media (max-width: 400px) {
            .reactor-pid {
                width: 100px;
                height: 100px;
                left: 15%;
            }
            
            .heat-exchanger-pid {
                width: 90px;
                height: 60px;
                right: 18%;
            }
            
            .pump-pid {
                width: 70px;
                height: 70px;
            }
            
            .tank-pid {
                width: 75px;
                height: 90px;
            }
            
            .sensor-pid {
                width: 24px;
                height: 24px;
            }
            
            .sensor-icon-pid {
                font-size: 10px;
            }
            
            .display-value {
                font-size: 10px;
            }
        }

        /* Landscape mode adjustments */
        @media (orientation: landscape) and (max-height: 500px) {
            .reactor-pid {
                width: 90px;
                height: 90px;
                top: 20%;
            }
            
            .heat-exchanger-pid {
                width: 85px;
                height: 55px;
                top: 12%;
            }
            
            .pump-pid {
                width: 65px;
                height: 65px;
                bottom: 15%;
            }
            
            .tank-pid {
                width: 70px;
                height: 85px;
                top: 35%;
            }
        }

        /* Mobile pipes */
        .pipe {
            position: absolute;
            background: linear-gradient(90deg, var(--border-color), #64748b);
            border-radius: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        .pipe-horizontal {
            height: 4px;
        }

        .pipe-vertical {
            width: 4px;
        }

        /* Mobile sensors */
        .sensor {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--status-green);
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .sensor:active {
            transform: scale(1.1);
        }

        .sensor-label {
            position: absolute;
            top: -20px;
            left: -15px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 1px 4px;
            border-radius: 3px;
            font-size: 7px;
            white-space: nowrap;
            pointer-events: none;
        }

        .process-variable {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: var(--status-green);
            padding: 3px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 9px;
            font-weight: bold;
            border: 1px solid var(--success-green);
        }

        /* Mobile cards for data */
        .data-card {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .data-card h3 {
            color: var(--secondary-blue);
            font-size: 14px;
            margin-bottom: 10px;
            text-align: center;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
        }

        .data-item {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--secondary-blue);
            border-radius: 6px;
            padding: 8px;
            text-align: center;
        }

        .data-label {
            font-size: 9px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .data-value {
            font-size: 14px;
            font-weight: bold;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
        }

        /* Mobile controls */
        .control-section {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .control-section h4 {
            color: var(--secondary-blue);
            font-size: 12px;
            margin-bottom: 10px;
            text-align: center;
        }

        .control-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            gap: 8px;
        }

        .control-label {
            font-size: 10px;
            color: var(--text-secondary);
            min-width: 60px;
            flex-shrink: 0;
        }

        .control-input {
            flex: 1;
            background: var(--scada-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 8px;
            border-radius: 4px;
            font-size: 12px;
            min-height: 40px; /* Touch-friendly */
        }

        .control-input:focus {
            outline: none;
            border-color: var(--secondary-blue);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .control-button {
            padding: 10px 15px;
            background: var(--secondary-blue);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-height: 40px; /* Touch-friendly */
            touch-action: manipulation;
        }

        .control-button:active {
            transform: scale(0.95);
            background: var(--primary-blue);
        }

        .control-button.danger {
            background: var(--danger-red);
        }

        .control-button.success {
            background: var(--success-green);
        }

        /* Mobile charts */
        .chart-container {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 10px;
            height: 250px;
        }

        .chart-title {
            color: var(--secondary-blue);
            font-size: 12px;
            text-align: center;
            margin-bottom: 8px;
        }

        /* Mobile alarms */
        .alarm-list {
            max-height: 300px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .alarm-entry {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 6px;
            font-size: 11px;
            border-left: 4px solid;
        }

        .alarm-entry.critical {
            background: rgba(220, 38, 38, 0.2);
            border-color: var(--danger-red);
        }

        .alarm-entry.warning {
            background: rgba(251, 191, 36, 0.2);
            border-color: var(--warning-yellow);
        }

        .alarm-entry.info {
            background: rgba(59, 130, 246, 0.2);
            border-color: var(--secondary-blue);
        }

        .alarm-time {
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
            margin-right: 8px;
            min-width: 50px;
            font-size: 10px;
        }

        .alarm-message {
            flex: 1;
            color: var(--text-primary);
        }

        /* AI Control Mobile */
        .ai-control-mobile {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(16, 185, 129, 0.2));
            border: 1px solid var(--secondary-blue);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .ai-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .ai-brain {
            width: 30px;
            height: 30px;
            background: var(--success-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            animation: pulse 2s infinite;
            flex-shrink: 0;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .ai-info {
            flex: 1;
        }

        .ai-info h4 {
            color: var(--success-green);
            font-size: 12px;
            margin: 0;
        }

        .ai-info p {
            color: var(--text-secondary);
            font-size: 10px;
            margin: 2px 0 0 0;
        }

        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        .button-grid .control-button {
            font-size: 10px;
            padding: 8px;
            line-height: 1.2;
        }

        /* Neural log mobile */
        .neural-log {
            background: var(--scada-bg);
            border-radius: 6px;
            padding: 8px;
            height: 120px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 9px;
            color: var(--status-green);
            border: 1px solid var(--border-color);
            -webkit-overflow-scrolling: touch;
        }

        /* Quick action buttons */
        .quick-actions {
            display: flex;
            gap: 6px;
            margin-bottom: 10px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            padding: 5px 0;
        }

        .quick-action {
            min-width: 80px;
            padding: 8px 12px;
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 10px;
            text-align: center;
            cursor: pointer;
            white-space: nowrap;
            touch-action: manipulation;
        }

        .quick-action:active {
            background: var(--secondary-blue);
            color: white;
        }

        /* Modal adjustments for mobile */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
            padding: 10px;
        }

        .modal-overlay.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-modal {
            background: var(--panel-bg);
            border: 2px solid var(--secondary-blue);
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue));
            color: white;
            padding: 12px 15px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 14px;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            min-width: 30px;
            min-height: 30px;
        }

        .modal-body {
            padding: 15px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px) scale(0.9); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }

        /* Responsive breakpoints */
        @media (min-width: 390px) {
            .system-info p {
                display: block;
            }
            
            .system-info h1 {
                font-size: 16px;
            }
        }

        @media (min-width: 480px) {
            .data-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .button-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 768px) {
            .mobile-container {
                max-width: 768px;
                margin: 0 auto;
            }
            
            .data-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .process-overview-mobile {
                height: 50vh;
            }
        }

        /* Landscape orientation adjustments */
        @media (orientation: landscape) and (max-height: 500px) {
            .process-overview-mobile {
                height: 40vh;
            }
            
            .chart-container {
                height: 200px;
            }
        }

        /* Touch improvements */
        .touchable {
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }

        /* Loading state */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Mobile Neural Network Visualization */
        .neural-network-mobile {
            position: relative;
            height: 300px;
            background: var(--scada-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin-bottom: 15px;
            overflow: hidden;
        }

        .neural-layer-mobile {
            position: absolute;
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding-top: 25px;
        }

        .layer-label {
            position: absolute;
            top: 5px;
            font-size: 8px;
            color: var(--text-secondary);
            background: rgba(0,0,0,0.8);
            padding: 2px 6px;
            border-radius: 3px;
            white-space: nowrap;
        }

        .neural-neuron-mobile {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid var(--secondary-blue);
            background: var(--panel-bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            font-weight: bold;
            color: white;
            transition: all 0.5s ease;
            cursor: pointer;
            position: relative;
            touch-action: manipulation;
        }

        .neural-neuron-mobile:active {
            transform: scale(1.1);
        }

        .neural-neuron-mobile.active {
            background: var(--success-green);
            border-color: var(--success-green);
            box-shadow: 0 0 15px var(--success-green);
            animation: neuron-pulse-mobile 2s infinite;
        }

        .neural-neuron-mobile.inactive {
            background: var(--gray-dark);
            border-color: var(--gray-dark);
            opacity: 0.5;
        }

        .neural-neuron-mobile.input {
            background: var(--secondary-blue);
            border-color: var(--secondary-blue);
        }

        .neural-neuron-mobile.output {
            background: var(--warning-yellow);
            border-color: var(--warning-yellow);
            color: black;
        }

        .neuron-value {
            position: absolute;
            bottom: -15px;
            font-size: 6px;
            color: var(--text-secondary);
            background: rgba(0,0,0,0.8);
            padding: 1px 3px;
            border-radius: 2px;
            white-space: nowrap;
            min-width: 20px;
            text-align: center;
        }

        @keyframes neuron-pulse-mobile {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .neural-connections-svg {
            z-index: 1;
        }

        .neural-connection-mobile {
            stroke: var(--border-color);
            stroke-width: 1;
            transition: all 0.3s ease;
        }

        .neural-connection-mobile.active {
            stroke: var(--success-green);
            stroke-width: 2;
            filter: drop-shadow(0 0 3px var(--success-green));
        }

        .neural-connection-mobile.strong {
            stroke: var(--warning-yellow);
            stroke-width: 3;
            filter: drop-shadow(0 0 5px var(--warning-yellow));
        }

        /* Data Flow Animation */
        .data-flow-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 10px 0;
            height: 20px;
        }

        .flow-arrow {
            color: var(--success-green);
            font-size: 16px;
            animation: flow-pulse 2s infinite ease-in-out;
            opacity: 0;
        }

        @keyframes flow-pulse {
            0%, 100% { opacity: 0; transform: translateX(-10px); }
            30%, 70% { opacity: 1; transform: translateX(0); }
        }

        /* Weight Matrix Mobile */
        .weight-matrix-mobile {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .weight-row-mobile {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 9px;
        }

        .weight-label {
            color: var(--text-secondary);
            min-width: 30px;
            font-size: 8px;
        }

        .weight-value {
            background: var(--scada-bg);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            padding: 2px 4px;
            font-family: 'Courier New', monospace;
            color: var(--text-primary);
            min-width: 40px;
            text-align: center;
            font-size: 8px;
        }

        .weight-value.positive {
            background: rgba(34, 197, 94, 0.2);
            border-color: var(--success-green);
            color: var(--success-green);
        }

        .weight-value.negative {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--danger-red);
            color: var(--danger-red);
        }

        /* Status indicators mobile */
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-ok { background: var(--success-green); }
        .status-warning { background: var(--warning-yellow); }
        .status-error { background: var(--danger-red); }

        /* Loading state */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Touch improvements */
        .touchable {
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="scada-header">
        <div class="scada-title">
            <div class="company-logo">üè≠</div>
            <div class="system-info">
                <h1>SCADA/DCS Mobile</h1>
                <p>Heat Exchange Process Control - AI-Enhanced PID v2.1</p>
            </div>
        </div>
        <div class="header-controls">
            <div class="alarm-indicator touchable" id="alarm-status" onclick="acknowledgeAlarms()">
                <span id="alarm-count">2</span> ALARM
            </div>
            <div class="system-time" id="system-time">--:--:--</div>
        </div>
    </div>

    <!-- Mobile Navigation -->
    <div class="mobile-nav">
        <button class="nav-tab active touchable" onclick="switchView('overview')">üìä √Åttekint√©s</button>
        <button class="nav-tab touchable" onclick="switchView('data')">üìä Adatok</button>
        <button class="nav-tab touchable" onclick="switchView('control')">‚öôÔ∏è Vez√©rl√©s</button>
        <button class="nav-tab touchable" onclick="switchView('trends')">üìà Trendek</button>
        <button class="nav-tab touchable" onclick="switchView('alarms')">üö® Riaszt√°sok</button>
    </div>

    <!-- Mobile Container -->
    <div class="mobile-container">
        
        <!-- Overview View -->
        <div class="view-section active" id="overview-view">
            <div class="quick-actions">
                <div class="quick-action touchable" onclick="toggleMaintenance()">üîß Karbantart√°s</div>
                <div class="quick-action touchable" onclick="openPIDModal()">‚öôÔ∏è PID</div>
                <div class="quick-action touchable" onclick="openNeuralModal()">üß† AI</div>
                <div class="quick-action touchable" onclick="exportReport()">üìã Jelent√©s</div>
            </div>

            <div class="process-overview-mobile">
                <!-- Main horizontal pipe at bottom -->
                <div class="pipe-bottom" style="position: absolute; bottom: 25%; left: 8%; width: 84%; height: 8px; background: #5A6B7D; border-radius: 4px; z-index: 1;"></div>
                
                <!-- Vertical pipe from reactor to bottom pipe -->
                <div class="pipe-reactor-down" style="position: absolute; left: 25%; top: 52%; width: 8px; height: 23%; background: #5A6B7D; border-radius: 4px; z-index: 1;"></div>
                
                <!-- Horizontal pipe from reactor to heat exchanger -->
                <div class="pipe-reactor-hx" style="position: absolute; left: 35%; top: 35%; width: 30%; height: 8px; background: #5A6B7D; border-radius: 4px; z-index: 1;"></div>
                
                <!-- Vertical pipe from heat exchanger down -->
                <div class="pipe-hx-down" style="position: absolute; right: 15%; top: 42%; width: 8px; height: 33%; background: #5A6B7D; border-radius: 4px; z-index: 1;"></div>
                
                <!-- Small horizontal pipe to tank -->
                <div class="pipe-to-tank" style="position: absolute; right: 23%; top: 70%; width: 15%; height: 8px; background: #5A6B7D; border-radius: 4px; z-index: 1;"></div>

                <!-- R-001 REAKTOR - large blue circle -->
                <div class="reactor-pid" onclick="showEquipmentInfo('reactor')" title="R-001 Reaktor">
                    <div style="font-size: 11px; font-weight: bold; color: white; line-height: 1;">R-001</div>
                    <div style="font-size: 9px; color: white; line-height: 1;">REAKTOR</div>
                </div>

                <!-- HX-001 H≈êCSER√âL≈ê - green rectangle -->
                <div class="heat-exchanger-pid" onclick="showEquipmentInfo('hx')" title="HX-001 H≈ëcser√©l≈ë">
                    <div style="font-size: 9px; font-weight: bold; color: white; line-height: 1; margin-bottom: 2px;">HX-001</div>
                    <div style="font-size: 7px; color: white; line-height: 1;">H≈êCSER√âL≈ê</div>
                </div>

                <!-- V-001 - purple diamond valve -->
                <div class="valve-pid" onclick="showEquipmentInfo('valve')" title="V-001 Vez√©rl≈ë Szelep">
                    <div style="font-size: 8px; color: white; font-weight: bold; transform: rotate(-45deg);">V-001</div>
                </div>

                <!-- P-001 - orange circle pump -->
                <div class="pump-pid" onclick="showEquipmentInfo('pump')" title="P-001 Pumpa">
                    <div style="font-size: 10px; font-weight: bold; color: white;">P-001</div>
                </div>

                <!-- T-001 TANK - gray rounded rectangle -->
                <div class="tank-pid" onclick="showEquipmentInfo('tank')" title="T-001 Tank">
                    <div style="font-size: 9px; font-weight: bold; color: white; line-height: 1;">T-001</div>
                    <div style="font-size: 7px; color: white; line-height: 1;">TANK</div>
                </div>

                <!-- Sensors - small green circles with white icons -->
                
                <!-- TI-101 on reactor -->
                <div class="sensor-pid" style="left: 27%; top: 15%;" onclick="showSensorInfo('TI-101')" title="TI-101">
                    <div class="sensor-icon-pid">T</div>
                    <div class="sensor-tag-pid">TI-101</div>
                </div>

                <!-- PI sensor on reactor (pressure) -->
                <div class="sensor-pid" style="left: 27%; top: 65%;" onclick="showSensorInfo('PI-201')" title="PI-201">
                    <div class="sensor-icon-pid">P</div>
                    <!-- No visible tag in the image -->
                </div>

                <!-- FI-301 on bottom pipe -->
                <div class="sensor-pid" style="left: 50%; bottom: 15%;" onclick="showSensorInfo('FI-301')" title="FI-301">
                    <div class="sensor-icon-pid">F</div>
                    <div class="sensor-tag-pid">FI-301</div>
                </div>

                <!-- TK sensor on heat exchanger -->
                <div class="sensor-pid" style="right: 25%; top: 8%;" onclick="showSensorInfo('TI-102')" title="TI-102">
                    <div class="sensor-icon-pid">T</div>
                    <div class="sensor-tag-pid">TK</div>
                </div>

                <!-- P sensor on tank -->
                <div class="sensor-pid" style="right: 8%; top: 42%;" onclick="showSensorInfo('PI-202')" title="PI-202">
                    <div class="sensor-icon-pid">P</div>
                    <!-- No visible tag in the image -->
                </div>

                <!-- Process value displays - green bordered black boxes -->
                
                <!-- 65.1¬∞C - reactor temperature -->
                <div class="process-display-pid temp" style="left: 8%; top: 25%;" id="display-temp1">
                    <div class="display-value">65.1¬∞C</div>
                </div>

                <!-- 5.0 bar - reactor pressure -->
                <div class="process-display-pid pressure" style="left: 8%; top: 58%;" id="display-pressure1">
                    <div class="display-value">5.0 bar</div>
                </div>

                <!-- 3.1 L/min - flow -->
                <div class="process-display-pid flow" style="left: 42%; bottom: 8%;" id="display-flow1">
                    <div class="display-value">3.1 L/min</div>
                </div>

                <!-- 44.7¬∞C - heat exchanger temperature -->
                <div class="process-display-pid temp" style="right: 20%; top: 5%;" id="display-temp2">
                    <div class="display-value">44.7¬∞C</div>
                </div>
            </div>

            <div class="ai-control-mobile">
                <div class="ai-status">
                    <div class="ai-brain">üß†</div>
                    <div class="ai-info">
                        <h4>AI-PID AKT√çV</h4>
                        <p>Neur√°lis H√°l√≥ v2.1 - Tanul√°s: <span id="ai-learning-status">AKT√çV</span></p>
                    </div>
                </div>
                <div class="button-grid">
                    <button class="control-button touchable" onclick="toggleAILearning()">AI Tanul√°s</button>
                    <button class="control-button touchable" onclick="tunePID()">üéØ Auto Tune</button>
                    <button class="control-button touchable" onclick="resetAI()">üîÑ Reset</button>
                    <button class="control-button touchable" onclick="openNeuralModal()">üß† Neur√°lis</button>
                </div>
            </div>

            <div class="data-card">
                <h3>Neural Log</h3>
                <div class="neural-log" id="neural-log">
                    <div style="color: #00ff00;">[AI-SYSTEM] Rendszer inicializ√°lva</div>
                    <div style="color: #ffff00;">[NEURAL-NET] Tanul√°s akt√≠v</div>
                    <div style="color: #00ffff;">[PID-TUNER] Param√©terek optimaliz√°lva</div>
                </div>
            </div>
        </div>

        <!-- Data View -->
        <div class="view-section" id="data-view">
            <div class="data-card">
                <h3>üå°Ô∏è H≈ëm√©rs√©klet Szenzorok</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">TI-101 Reaktor</div>
                        <div class="data-value" id="data-ti101">65.2¬∞C</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">TI-102 H≈ëcser√©l≈ë</div>
                        <div class="data-value" id="data-ti102">42.8¬∞C</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">TI-103 Tank</div>
                        <div class="data-value" id="data-ti103">38.5¬∞C</div>
                    </div>
                </div>
            </div>

            <div class="data-card">
                <h3>üìä Nyom√°s Szenzorok</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">PI-201 Reaktor</div>
                        <div class="data-value" id="data-pi201">5.2 bar</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">PI-202 Vezet√©k</div>
                        <div class="data-value" id="data-pi202">4.8 bar</div>
                    </div>
                </div>
            </div>

            <div class="data-card">
                <h3>üíß √Åraml√°s M√©r√©s</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">FI-301 F≈ë √Åraml√°s</div>
                        <div class="data-value" id="data-fi301">3.2 L/min</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">FI-302 Mell√©k</div>
                        <div class="data-value" id="data-fi302">1.8 L/min</div>
                    </div>
                </div>
            </div>

            <div class="data-card">
                <h3>üéØ Aktu√°lis C√©l√©rt√©kek</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">H≈ëm√©rs√©klet SP</div>
                        <div class="data-value" id="data-temp-sp">65.0¬∞C</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Nyom√°s SP</div>
                        <div class="data-value" id="data-pressure-sp">5.0 bar</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">√Åraml√°s SP</div>
                        <div class="data-value" id="data-flow-sp">3.0 L/min</div>
                    </div>
                </div>
            </div>

            <div class="data-card">
                <h3>üß† AI-PID Param√©terek</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">Kp</div>
                        <div class="data-value" id="data-kp">1.200</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Ki</div>
                        <div class="data-value" id="data-ki">0.1500</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Kd</div>
                        <div class="data-value" id="data-kd">0.250</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Teljes√≠tm√©ny</div>
                        <div class="data-value" id="data-performance">95.0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control View -->
        <div class="view-section" id="control-view">
            <div class="control-section">
                <h4>üéØ C√©l√©rt√©k Be√°ll√≠t√°sok</h4>
                
                <div class="control-row">
                    <span class="control-label">H≈ëm√©rs√©klet:</span>
                    <input type="number" class="control-input touchable" id="temp-setpoint-mobile" value="65.0" step="0.1" min="20" max="100" onchange="updateSetpoint('temp')" oninput="previewSetpoint('temp')">
                    <span style="font-size: 10px; color: var(--text-secondary);">¬∞C</span>
                </div>
                
                <div class="control-row">
                    <span class="control-label">Nyom√°s:</span>
                    <input type="number" class="control-input touchable" id="pressure-setpoint-mobile" value="5.0" step="0.1" min="0" max="15" onchange="updateSetpoint('pressure')" oninput="previewSetpoint('pressure')">
                    <span style="font-size: 10px; color: var(--text-secondary);">bar</span>
                </div>
                
                <div class="control-row">
                    <span class="control-label">√Åraml√°s:</span>
                    <input type="number" class="control-input touchable" id="flow-setpoint-mobile" value="3.0" step="0.1" min="0" max="10" onchange="updateSetpoint('flow')" oninput="previewSetpoint('flow')">
                    <span style="font-size: 10px; color: var(--text-secondary);">L/min</span>
                </div>

                <div style="margin-top: 15px;">
                    <div style="font-size: 10px; color: var(--text-secondary); margin-bottom: 8px;">√Ållapot:</div>
                    <div style="font-size: 9px; color: var(--text-secondary);">
                        <div><span class="status-indicator status-ok"></span>H≈ëm√©rs√©klet: <span id="temp-status-mobile" style="color: var(--status-green);">OK</span></div>
                        <div><span class="status-indicator status-ok"></span>Nyom√°s: <span id="pressure-status-mobile" style="color: var(--status-green);">OK</span></div>
                        <div><span class="status-indicator status-ok"></span>√Åraml√°s: <span id="flow-status-mobile" style="color: var(--status-green);">OK</span></div>
                    </div>
                </div>
            </div>

            <div class="control-section">
                <h4>‚ö° Gyors Be√°ll√≠t√°sok</h4>
                <div class="button-grid">
                    <button class="control-button touchable" onclick="setQuickSetpoints('normal')">Norm√°l</button>
                    <button class="control-button touchable" onclick="setQuickSetpoints('high')">Magas</button>
                    <button class="control-button touchable" onclick="setQuickSetpoints('low')">Alacsony</button>
                    <button class="control-button danger touchable" onclick="setQuickSetpoints('emergency')">V√©szhelyzet</button>
                </div>
            </div>

            <div class="control-section">
                <h4>üß† AI Vez√©rl√©s</h4>
                
                <div class="control-row">
                    <span class="control-label">AI M√≥d:</span>
                    <select class="control-input touchable" id="ai-mode-mobile" onchange="changeAIMode()">
                        <option value="neural">Neur√°lis H√°l√≥</option>
                        <option value="predictive">Predikt√≠v MPC</option>
                        <option value="adaptive">Adapt√≠v PID</option>
                        <option value="fuzzy">Fuzzy Logic</option>
                    </select>
                </div>
                
                <div class="button-grid">
                    <button class="control-button success touchable" id="ai-learn-btn-mobile" onclick="toggleAILearning()">TANUL√ÅS AKT√çV</button>
                    <button class="control-button touchable" onclick="tunePID()">üéØ AUTO TUNE</button>
                    <button class="control-button touchable" onclick="resetAI()">üîÑ RESET AI</button>
                    <button class="control-button touchable" onclick="openPIDModal()">‚öôÔ∏è PID INFO</button>
                </div>
            </div>

            <div class="control-section">
                <h4>üîß Rendszer M≈±veletek</h4>
                <div class="button-grid">
                    <button class="control-button touchable" onclick="toggleMaintenance()">üîß Karbantart√°s</button>
                    <button class="control-button touchable" onclick="exportReport()">üìã Jelent√©s</button>
                    <button class="control-button touchable" onclick="acknowledgeAlarms()">‚úì Riaszt√°s OK</button>
                    <button class="control-button danger touchable" onclick="clearAlarms()">üóëÔ∏è Riaszt√°s T√∂rl√©s</button>
                </div>
            </div>
        </div>

        <!-- Trends View -->
        <div class="view-section" id="trends-view">
            <div class="chart-container">
                <div class="chart-title">üå°Ô∏è H≈ëm√©rs√©klet Trend</div>
                <canvas id="temp-trend-mobile" width="300" height="200"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">üìä Nyom√°s Trend</div>
                <canvas id="pressure-trend-mobile" width="300" height="200"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">üß† PID Param√©terek Trend</div>
                <canvas id="pid-trend-mobile" width="300" height="200"></canvas>
            </div>

            <div class="control-section">
                <h4>‚è±Ô∏è Trend Be√°ll√≠t√°sok</h4>
                <div class="control-row">
                    <span class="control-label">Id≈ëtartam:</span>
                    <select class="control-input touchable" id="trend-timespan-mobile" onchange="updateTrendTimespan()">
                        <option value="1">1 perc</option>
                        <option value="5">5 perc</option>
                        <option value="10" selected>10 perc</option>
                        <option value="30">30 perc</option>
                    </select>
                </div>
                <div style="margin-top: 10px; font-size: 9px; color: var(--text-secondary); text-align: center;">
                    üìä Friss√≠t√©s: 5 m√°sodpercenk√©nt | Adatpontok: utols√≥ 20 m√©r√©s
                </div>
            </div>
        </div>

        <!-- Alarms View -->
        <div class="view-section" id="alarms-view">
            <div class="data-card">
                <h3>üö® Akt√≠v Riaszt√°sok</h3>
                <div class="alarm-list" id="alarms-list-mobile">
                    <div class="alarm-entry info">
                        <span class="alarm-time">12:35</span>
                        <span class="alarm-message">AI-PID tanul√°s aktiv√°lva</span>
                    </div>
                    <div class="alarm-entry info">
                        <span class="alarm-time">12:34</span>
                        <span class="alarm-message">SCADA/DCS rendszer elind√≠tva</span>
                    </div>
                </div>
                
                <div class="button-grid" style="margin-top: 15px;">
                    <button class="control-button touchable" onclick="acknowledgeAlarms()">‚úì Nyugt√°z√°s</button>
                    <button class="control-button touchable" onclick="clearAlarms()">üóëÔ∏è T√∂rl√©s</button>
                    <button class="control-button touchable" onclick="printAlarms()">üñ®Ô∏è Print</button>
                    <button class="control-button touchable" onclick="exportReport()">üìã Jelent√©s</button>
                </div>
            </div>

            <div class="data-card">
                <h3>üìä Riaszt√°s Statisztika</h3>
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">√ñsszes Riaszt√°s</div>
                        <div class="data-value" id="total-alarms">2</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Kritikus</div>
                        <div class="data-value" style="color: var(--danger-red);">0</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Figyelmeztet√©s</div>
                        <div class="data-value" style="color: var(--warning-yellow);">0</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Inform√°ci√≥</div>
                        <div class="data-value" style="color: var(--secondary-blue);">2</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile PID Modal -->
    <div class="modal-overlay" id="pid-modal-overlay-mobile" onclick="closePIDModal()">
        <div class="mobile-modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>‚öôÔ∏è PID Param√©terek</h3>
                <button class="modal-close touchable" onclick="closePIDModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="data-grid">
                    <div class="data-item">
                        <div class="data-label">Kp (Proporcion√°lis)</div>
                        <div class="data-value" id="modal-pid-kp-mobile">1.200</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Ki (Integr√°l)</div>
                        <div class="data-value" id="modal-pid-ki-mobile">0.1500</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Kd (Deriv√°lt)</div>
                        <div class="data-value" id="modal-pid-kd-mobile">0.250</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Teljes√≠tm√©ny</div>
                        <div class="data-value" id="modal-pid-performance-mobile">95.0%</div>
                    </div>
                </div>
                
                <div style="margin-top: 15px;">
                    <h4 style="color: var(--secondary-blue); font-size: 12px; margin-bottom: 10px;">H≈ëm√©rs√©klet Szab√°lyoz√°s</h4>
                    <div class="data-grid">
                        <div class="data-item">
                            <div class="data-label">Aktu√°lis Hiba</div>
                            <div class="data-value" id="modal-temp-error-mobile">0.0¬∞C</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Integr√°l</div>
                            <div class="data-value" id="modal-temp-integral-mobile">0.0</div>
                        </div>
                        <div class="data-item">
                            <div class="data-label">Deriv√°lt</div>
                            <div class="data-value" id="modal-temp-derivative-mobile">0.0</div>
                        </div>
                    </div>
                </div>
                
                <div class="button-grid" style="margin-top: 15px;">
                    <button class="control-button touchable" onclick="tunePID()">üéØ Auto Tune</button>
                    <button class="control-button touchable" onclick="resetAI()">üîÑ Reset PID</button>
                    <button class="control-button touchable" onclick="closePIDModal()">‚úÖ Bez√°r√°s</button>
                </div>
            </div>
        </div>
    </div>

            <!-- Mobile Neural Network Modal -->
    <div class="modal-overlay" id="neural-modal-overlay-mobile" onclick="closeNeuralModal()">
        <div class="mobile-modal" onclick="event.stopPropagation()" style="width: 95vw; max-width: 500px;">
            <div class="modal-header">
                <h3>üß† Neur√°lis H√°l√≥ Vizualiz√°ci√≥</h3>
                <button class="modal-close touchable" onclick="closeNeuralModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 12px; color: var(--secondary-blue); margin-bottom: 5px;">Architekt√∫ra: 3-6-4-3</div>
                    <div style="font-size: 10px; color: var(--text-secondary);">Bemenet ‚Üí Rejtett1 ‚Üí Rejtett2 ‚Üí Kimenet</div>
                </div>

                <!-- Mobile Neural Network Visualization -->
                <div class="neural-network-mobile" id="neural-network-mobile">
                    <!-- Input Layer -->
                    <div class="neural-layer-mobile" style="left: 5%;">
                        <div class="layer-label">Bemenet</div>
                        <div class="neural-neuron-mobile input" data-neuron="temp" title="H≈ëm√©rs√©klet bemenet">
                            <span>T</span>
                            <div class="neuron-value" id="neuron-temp-val">0.52</div>
                        </div>
                        <div class="neural-neuron-mobile input" data-neuron="pressure" title="Nyom√°s bemenet">
                            <span>P</span>
                            <div class="neuron-value" id="neuron-pressure-val">0.44</div>
                        </div>
                        <div class="neural-neuron-mobile input" data-neuron="flow" title="√Åraml√°s bemenet">
                            <span>F</span>
                            <div class="neuron-value" id="neuron-flow-val">0.67</div>
                        </div>
                    </div>
                    
                    <!-- Hidden Layer 1 -->
                    <div class="neural-layer-mobile" style="left: 30%;">
                        <div class="layer-label">Rejtett 1</div>
                        <div class="neural-neuron-mobile" data-neuron="h1_1">H1</div>
                        <div class="neural-neuron-mobile" data-neuron="h1_2">H2</div>
                        <div class="neural-neuron-mobile" data-neuron="h1_3">H3</div>
                        <div class="neural-neuron-mobile" data-neuron="h1_4">H4</div>
                        <div class="neural-neuron-mobile" data-neuron="h1_5">H5</div>
                        <div class="neural-neuron-mobile" data-neuron="h1_6">H6</div>
                    </div>
                    
                    <!-- Hidden Layer 2 -->
                    <div class="neural-layer-mobile" style="left: 55%;">
                        <div class="layer-label">Rejtett 2</div>
                        <div class="neural-neuron-mobile" data-neuron="h2_1">H1</div>
                        <div class="neural-neuron-mobile" data-neuron="h2_2">H2</div>
                        <div class="neural-neuron-mobile" data-neuron="h2_3">H3</div>
                        <div class="neural-neuron-mobile" data-neuron="h2_4">H4</div>
                    </div>
                    
                    <!-- Output Layer -->
                    <div class="neural-layer-mobile" style="left: 80%;">
                        <div class="layer-label">Kimenet</div>
                        <div class="neural-neuron-mobile output" data-neuron="kp_out" title="Kp kimenet">
                            <span>Kp</span>
                            <div class="neuron-value" id="neuron-kp-val">1.20</div>
                        </div>
                        <div class="neural-neuron-mobile output" data-neuron="ki_out" title="Ki kimenet">
                            <span>Ki</span>
                            <div class="neuron-value" id="neuron-ki-val">0.15</div>
                        </div>
                        <div class="neural-neuron-mobile output" data-neuron="kd_out" title="Kd kimenet">
                            <span>Kd</span>
                            <div class="neuron-value" id="neuron-kd-val">0.25</div>
                        </div>
                    </div>

                    <!-- Connections will be drawn by JavaScript -->
                    <svg class="neural-connections-svg" id="neural-svg" width="100%" height="100%" style="position: absolute; top: 0; left: 0; pointer-events: none;">
                    </svg>
                </div>

                <!-- Data Flow Indicator -->
                <div class="data-flow-indicator" id="data-flow">
                    <div class="flow-arrow" style="animation-delay: 0s;">‚û§</div>
                    <div class="flow-arrow" style="animation-delay: 0.3s;">‚û§</div>
                    <div class="flow-arrow" style="animation-delay: 0.6s;">‚û§</div>
                </div>
                
                <div class="data-grid" style="margin-top: 15px;">
                    <div class="data-item">
                        <div class="data-label">Akt√≠v Kapcsolatok</div>
                        <div class="data-value" id="active-connections-mobile">24/42</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Tanul√°si R√°ta</div>
                        <div class="data-value" id="learning-rate-mobile">0.001</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Hibafunkci√≥</div>
                        <div class="data-value" id="error-function-mobile">0.0023</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Epoch Sz√°m</div>
                        <div class="data-value" id="epoch-count-mobile">1247</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Konvergencia</div>
                        <div class="data-value" id="convergence-mobile">94.2%</div>
                    </div>
                    <div class="data-item">
                        <div class="data-label">Predikci√≥s Pontoss√°g</div>
                        <div class="data-value" id="prediction-accuracy-mobile">97.8%</div>
                    </div>
                </div>

                <!-- Weight Matrix Sample -->
                <div style="margin-top: 15px; background: rgba(255, 255, 255, 0.05); border-radius: 6px; padding: 10px;">
                    <h5 style="color: var(--secondary-blue); margin: 0 0 8px 0; font-size: 11px; text-align: center;">‚öñÔ∏è S√∫lym√°trix Minta (Bemenet ‚Üí Rejtett1)</h5>
                    <div class="weight-matrix-mobile">
                        <div class="weight-row-mobile">
                            <span class="weight-label">T‚ÜíH1:</span>
                            <span class="weight-value positive" id="w_t_h1_mobile">0.342</span>
                            <span class="weight-label">T‚ÜíH2:</span>
                            <span class="weight-value negative" id="w_t_h2_mobile">-0.158</span>
                        </div>
                        <div class="weight-row-mobile">
                            <span class="weight-label">P‚ÜíH1:</span>
                            <span class="weight-value negative" id="w_p_h1_mobile">-0.234</span>
                            <span class="weight-label">P‚ÜíH2:</span>
                            <span class="weight-value positive" id="w_p_h2_mobile">0.567</span>
                        </div>
                        <div class="weight-row-mobile">
                            <span class="weight-label">F‚ÜíH1:</span>
                            <span class="weight-value positive" id="w_f_h1_mobile">0.445</span>
                            <span class="weight-label">F‚ÜíH2:</span>
                            <span class="weight-value negative" id="w_f_h2_mobile">-0.312</span>
                        </div>
                    </div>
                </div>
                
                <div class="button-grid" style="margin-top: 15px;">
                    <button class="control-button touchable" onclick="simulateTraining()">üéØ Tan√≠t√°s</button>
                    <button class="control-button touchable" onclick="resetNeuralNetwork()">üîÑ Reset</button>
                    <button class="control-button touchable" onclick="exportNeuralData()">üíæ Export</button>
                    <button class="control-button touchable" onclick="closeNeuralModal()">‚úÖ Bez√°r√°s</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mobile-optimized SCADA/DCS System Variables
        let isRunning = true;
        let maintenanceMode = false;
        let aiLearningActive = true;
        let alarmCount = 2;
        let currentView = 'overview';
        
        // Process Variables
        let processData = {
            temperature: 65.2,
            pressure: 5.2,
            flow: 3.2,
            tempSetpoint: 65.0,
            pressureSetpoint: 5.0,
            flowSetpoint: 3.0,
            reactorTemp: 65.2,
            hxOutletTemp: 42.8,
            tankTemp: 38.5,
            reactorPressure: 5.2,
            linePressure: 4.8,
            mainFlow: 3.2,
            bypassFlow: 1.8
        };

        // AI Controller
        let aiController = {
            mode: 'neural',
            learning: true,
            iterations: 0,
            kp: 1.2,
            ki: 0.15,
            kd: 0.25,
            performance: 0.95,
            tempError: 0,
            tempErrorPrev: 0,
            tempIntegral: 0,
            pressureError: 0,
            pressureErrorPrev: 0,
            pressureIntegral: 0,
            flowError: 0,
            flowErrorPrev: 0,
            flowIntegral: 0
        };

        // Neural Network State
        let neuralNetwork = {
            weights: {
                input_hidden1: [],
                hidden1_hidden2: [],
                hidden2_output: []
            },
            activations: {
                input: [0, 0, 0],
                hidden1: [0, 0, 0, 0, 0, 0],
                hidden2: [0, 0, 0, 0],
                output: [0, 0, 0]
            },
            learningRate: 0.001,
            epochs: 1247,
            error: 0.0023,
            convergence: 94.2
        };

        // Chart objects
        let tempTrendChart = null;
        let pressureTrendChart = null;
        let pidTrendChart = null;

        // Mobile Navigation
        function switchView(view) {
            currentView = view;
            
            // Update nav tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const viewSections = document.querySelectorAll('.view-section');
            viewSections.forEach(section => section.classList.remove('active'));
            
            // Find and activate the correct tab
            tabs.forEach(tab => {
                if ((view === 'overview' && tab.textContent.includes('√Åttekint√©s')) ||
                    (view === 'data' && tab.textContent.includes('Adatok')) ||
                    (view === 'control' && tab.textContent.includes('Vez√©rl√©s')) ||
                    (view === 'trends' && tab.textContent.includes('Trendek')) ||
                    (view === 'alarms' && tab.textContent.includes('Riaszt√°sok'))) {
                    tab.classList.add('active');
                }
            });
            
            // Show the correct view
            const targetView = document.getElementById(view + '-view');
            if (targetView) {
                targetView.classList.add('active');
            }
            
            addNeuralLog(`[VIEW] V√°lt√°s: ${view}`, '#00ffff');
            
            // Special handling for trends view - initialize charts if needed
            if (view === 'trends' && !tempTrendChart) {
                setTimeout(initializeCharts, 100);
            }
        }

        // Modal Functions
        function openPIDModal() {
            const modal = document.getElementById('pid-modal-overlay-mobile');
            if (modal) {
                modal.classList.add('show');
                updatePIDModal();
                addNeuralLog('[UI] PID param√©terek ablak megnyitva', '#00ffff');
            }
        }

        function closePIDModal() {
            const modal = document.getElementById('pid-modal-overlay-mobile');
            if (modal) {
                modal.classList.remove('show');
                addNeuralLog('[UI] PID param√©terek ablak bez√°rva', '#00ffff');
            }
        }

        // Neural Network Functions - Enhanced for Mobile Visualization
        function openNeuralModal() {
            const modal = document.getElementById('neural-modal-overlay-mobile');
            if (modal) {
                modal.classList.add('show');
                setTimeout(() => {
                    initializeNeuralVisualization();
                    startNeuralAnimation();
                }, 100);
                updateNeuralStats();
                addNeuralLog('[UI] Neur√°lis h√°l√≥ vizualiz√°ci√≥ megnyitva', '#00ffff');
            }
        }

        function closeNeuralModal() {
            const modal = document.getElementById('neural-modal-overlay-mobile');
            if (modal) {
                modal.classList.remove('show');
                stopNeuralAnimation();
                addNeuralLog('[UI] Neur√°lis h√°l√≥ vizualiz√°ci√≥ bez√°rva', '#00ffff');
            }
        }

        let neuralAnimationInterval = null;
        let connectionAnimationInterval = null;

        function initializeNeuralVisualization() {
            // Initialize neural network weights if not done
            if (neuralNetwork.weights.input_hidden1.length === 0) {
                neuralNetwork.weights.input_hidden1 = generateWeightMatrix(3, 6);
                neuralNetwork.weights.hidden1_hidden2 = generateWeightMatrix(6, 4);
                neuralNetwork.weights.hidden2_output = generateWeightMatrix(4, 3);
            }
            
            // Create visual connections
            setTimeout(() => createNeuralConnectionsMobile(), 200);
            
            // Update weight display
            updateWeightDisplayMobile();
            
            // Initialize neuron states
            updateNeuronVisualsMobile();
        }

        function generateWeightMatrix(inputs, outputs) {
            const matrix = [];
            for (let i = 0; i < inputs; i++) {
                matrix[i] = [];
                for (let j = 0; j < outputs; j++) {
                    matrix[i][j] = (Math.random() - 0.5) * 2; // -1 to 1
                }
            }
            return matrix;
        }

        function createNeuralConnectionsMobile() {
            const svg = document.getElementById('neural-svg');
            if (!svg) return;
            
            // Clear existing connections
            svg.innerHTML = '';
            
            const networkContainer = document.getElementById('neural-network-mobile');
            if (!networkContainer) return;
            
            const containerRect = networkContainer.getBoundingClientRect();
            
            // Get neuron positions
            const inputNeurons = document.querySelectorAll('[data-neuron="temp"], [data-neuron="pressure"], [data-neuron="flow"]');
            const hidden1Neurons = document.querySelectorAll('[data-neuron^="h1_"]');
            const hidden2Neurons = document.querySelectorAll('[data-neuron^="h2_"]');
            const outputNeurons = document.querySelectorAll('[data-neuron="kp_out"], [data-neuron="ki_out"], [data-neuron="kd_out"]');
            
            // Input to Hidden1 connections
            inputNeurons.forEach((inputNeuron, i) => {
                hidden1Neurons.forEach((hiddenNeuron, j) => {
                    createSVGConnection(inputNeuron, hiddenNeuron, `conn_i${i}_h1${j}`, svg, networkContainer);
                });
            });
            
            // Hidden1 to Hidden2 connections
            hidden1Neurons.forEach((h1Neuron, i) => {
                hidden2Neurons.forEach((h2Neuron, j) => {
                    createSVGConnection(h1Neuron, h2Neuron, `conn_h1${i}_h2${j}`, svg, networkContainer);
                });
            });
            
            // Hidden2 to Output connections
            hidden2Neurons.forEach((h2Neuron, i) => {
                outputNeurons.forEach((outputNeuron, j) => {
                    createSVGConnection(h2Neuron, outputNeuron, `conn_h2${i}_o${j}`, svg, networkContainer);
                });
            });
        }

        function createSVGConnection(fromNeuron, toNeuron, connectionId, svg, container) {
            const fromRect = fromNeuron.getBoundingClientRect();
            const toRect = toNeuron.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            const fromX = fromRect.left - containerRect.left + fromRect.width / 2;
            const fromY = fromRect.top - containerRect.top + fromRect.height / 2;
            const toX = toRect.left - containerRect.left + toRect.width / 2;
            const toY = toRect.top - containerRect.top + toRect.height / 2;
            
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', fromX);
            line.setAttribute('y1', fromY);
            line.setAttribute('x2', toX);
            line.setAttribute('y2', toY);
            line.setAttribute('class', 'neural-connection-mobile');
            line.setAttribute('id', connectionId);
            
            // Random activity state
            if (Math.random() > 0.4) {
                line.classList.add('active');
                if (Math.random() > 0.8) {
                    line.classList.add('strong');
                }
            }
            
            svg.appendChild(line);
        }

        function startNeuralAnimation() {
            if (neuralAnimationInterval) clearInterval(neuralAnimationInterval);
            if (connectionAnimationInterval) clearInterval(connectionAnimationInterval);
            
            // Neuron state animation
            neuralAnimationInterval = setInterval(() => {
                forwardPassMobile();
                updateNeuronVisualsMobile();
                updateNeuronValues();
            }, 1000);
            
            // Connection activity animation
            connectionAnimationInterval = setInterval(() => {
                animateConnections();
            }, 500);
        }

        function stopNeuralAnimation() {
            if (neuralAnimationInterval) {
                clearInterval(neuralAnimationInterval);
                neuralAnimationInterval = null;
            }
            if (connectionAnimationInterval) {
                clearInterval(connectionAnimationInterval);
                connectionAnimationInterval = null;
            }
        }

        function forwardPassMobile() {
            // Simulate neural network forward pass with current process data
            neuralNetwork.activations.input = [
                (processData.reactorTemp - 50) / 50,        // Normalized temperature
                (processData.reactorPressure - 3) / 5,      // Normalized pressure
                (processData.mainFlow - 2) / 3              // Normalized flow
            ];
            
            // Hidden Layer 1
            for (let i = 0; i < 6; i++) {
                neuralNetwork.activations.hidden1[i] = 0;
                for (let j = 0; j < 3; j++) {
                    neuralNetwork.activations.hidden1[i] += 
                        neuralNetwork.activations.input[j] * neuralNetwork.weights.input_hidden1[j][i];
                }
                neuralNetwork.activations.hidden1[i] = sigmoid(neuralNetwork.activations.hidden1[i]);
            }
            
            // Hidden Layer 2
            for (let i = 0; i < 4; i++) {
                neuralNetwork.activations.hidden2[i] = 0;
                for (let j = 0; j < 6; j++) {
                    neuralNetwork.activations.hidden2[i] += 
                        neuralNetwork.activations.hidden1[j] * neuralNetwork.weights.hidden1_hidden2[j][i];
                }
                neuralNetwork.activations.hidden2[i] = sigmoid(neuralNetwork.activations.hidden2[i]);
            }
            
            // Output Layer
            for (let i = 0; i < 3; i++) {
                neuralNetwork.activations.output[i] = 0;
                for (let j = 0; j < 4; j++) {
                    neuralNetwork.activations.output[i] += 
                        neuralNetwork.activations.hidden2[j] * neuralNetwork.weights.hidden2_output[j][i];
                }
                neuralNetwork.activations.output[i] = sigmoid(neuralNetwork.activations.output[i]);
            }
            
            // Map outputs to PID parameters
            const outputs = neuralNetwork.activations.output;
            aiController.kp = 0.5 + outputs[0] * 2.5;    // 0.5 to 3.0
            aiController.ki = 0.05 + outputs[1] * 0.45;  // 0.05 to 0.5
            aiController.kd = 0.1 + outputs[2] * 0.9;    // 0.1 to 1.0
        }

        function sigmoid(x) {
            return 1 / (1 + Math.exp(-x));
        }

        function updateNeuronVisualsMobile() {
            // Update input neurons
            const neurons = [
                { element: document.querySelector('[data-neuron="temp"]'), activation: neuralNetwork.activations.input[0] },
                { element: document.querySelector('[data-neuron="pressure"]'), activation: neuralNetwork.activations.input[1] },
                { element: document.querySelector('[data-neuron="flow"]'), activation: neuralNetwork.activations.input[2] }
            ];
            
            // Hidden layer 1
            for (let i = 0; i < 6; i++) {
                neurons.push({
                    element: document.querySelector(`[data-neuron="h1_${i+1}"]`),
                    activation: neuralNetwork.activations.hidden1[i]
                });
            }
            
            // Hidden layer 2
            for (let i = 0; i < 4; i++) {
                neurons.push({
                    element: document.querySelector(`[data-neuron="h2_${i+1}"]`),
                    activation: neuralNetwork.activations.hidden2[i]
                });
            }
            
            // Output neurons
            neurons.push(
                { element: document.querySelector('[data-neuron="kp_out"]'), activation: neuralNetwork.activations.output[0] },
                { element: document.querySelector('[data-neuron="ki_out"]'), activation: neuralNetwork.activations.output[1] },
                { element: document.querySelector('[data-neuron="kd_out"]'), activation: neuralNetwork.activations.output[2] }
            );
            
            // Update visual states
            neurons.forEach(({ element, activation }) => {
                if (element) {
                    element.classList.remove('active', 'inactive');
                    
                    if (activation > 0.7) {
                        element.classList.add('active');
                    } else if (activation < 0.3) {
                        element.classList.add('inactive');
                    }
                }
            });
        }

        function updateNeuronValues() {
            // Update input neuron values
            const tempVal = document.getElementById('neuron-temp-val');
            const pressureVal = document.getElementById('neuron-pressure-val');
            const flowVal = document.getElementById('neuron-flow-val');
            
            if (tempVal) tempVal.textContent = neuralNetwork.activations.input[0].toFixed(2);
            if (pressureVal) pressureVal.textContent = neuralNetwork.activations.input[1].toFixed(2);
            if (flowVal) flowVal.textContent = neuralNetwork.activations.input[2].toFixed(2);
            
            // Update output neuron values
            const kpVal = document.getElementById('neuron-kp-val');
            const kiVal = document.getElementById('neuron-ki-val');
            const kdVal = document.getElementById('neuron-kd-val');
            
            if (kpVal) kpVal.textContent = aiController.kp.toFixed(2);
            if (kiVal) kiVal.textContent = aiController.ki.toFixed(3);
            if (kdVal) kdVal.textContent = aiController.kd.toFixed(2);
        }

        function animateConnections() {
            const connections = document.querySelectorAll('.neural-connection-mobile');
            connections.forEach(conn => {
                // Random connection activity
                if (Math.random() > 0.7) {
                    conn.classList.toggle('active');
                }
                if (Math.random() > 0.9) {
                    conn.classList.toggle('strong');
                }
            });
        }

        function updateWeightDisplayMobile() {
            // Update sample weights in the mobile UI
            if (neuralNetwork.weights.input_hidden1.length > 0) {
                const elements = {
                    'w_t_h1_mobile': neuralNetwork.weights.input_hidden1[0][0],
                    'w_t_h2_mobile': neuralNetwork.weights.input_hidden1[0][1],
                    'w_p_h1_mobile': neuralNetwork.weights.input_hidden1[1][0],
                    'w_p_h2_mobile': neuralNetwork.weights.input_hidden1[1][1],
                    'w_f_h1_mobile': neuralNetwork.weights.input_hidden1[2][0],
                    'w_f_h2_mobile': neuralNetwork.weights.input_hidden1[2][1]
                };
                
                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value.toFixed(3);
                        element.classList.remove('positive', 'negative');
                        element.classList.add(value > 0 ? 'positive' : 'negative');
                    }
                });
            }
        }

        function simulateTraining() {
            // Visual training effect
            const neurons = document.querySelectorAll('.neural-neuron-mobile');
            neurons.forEach(neuron => {
                neuron.classList.add('training-pulse');
                setTimeout(() => neuron.classList.remove('training-pulse'), 1000);
            });
            
            // Update network parameters
            neuralNetwork.epochs += Math.floor(10 + Math.random() * 20);
            neuralNetwork.error = Math.max(0.0001, neuralNetwork.error * (0.98 + Math.random() * 0.03));
            neuralNetwork.convergence = Math.min(99.9, neuralNetwork.convergence + Math.random() * 0.5);
            
            // Adjust weights slightly
            adjustWeightsMobile();
            updateWeightDisplayMobile();
            updateNeuralStats();
            
            // Animate data flow
            const flowArrows = document.querySelectorAll('.flow-arrow');
            flowArrows.forEach((arrow, index) => {
                arrow.style.animationDelay = (index * 0.2) + 's';
                arrow.style.color = 'var(--warning-yellow)';
                setTimeout(() => {
                    arrow.style.color = 'var(--success-green)';
                }, 2000);
            });
            
            addNeuralLog(`[NEURAL-TRAIN] Epoch ${neuralNetwork.epochs}, Hiba: ${neuralNetwork.error.toFixed(6)}`, '#ffff00');
            addAlarm('info', `Neur√°lis h√°l√≥ tan√≠t√°s: Epoch ${neuralNetwork.epochs}`, getCurrentTime());
            showMobileNotification('üß† Neur√°lis h√°l√≥ tan√≠t√°s futott', 'success');
        }

        function adjustWeightsMobile() {
            // Small random adjustments to simulate learning
            for (let i = 0; i < neuralNetwork.weights.input_hidden1.length; i++) {
                for (let j = 0; j < neuralNetwork.weights.input_hidden1[i].length; j++) {
                    neuralNetwork.weights.input_hidden1[i][j] += (Math.random() - 0.5) * 0.01;
                }
            }
        }

        function resetNeuralNetwork() {
            neuralNetwork.epochs = 0;
            neuralNetwork.error = 0.1;
            neuralNetwork.convergence = 50.0;
            
            // Reset visual state
            const neurons = document.querySelectorAll('.neural-neuron-mobile');
            neurons.forEach(neuron => {
                neuron.classList.remove('active', 'inactive');
            });
            
            const connections = document.querySelectorAll('.neural-connection-mobile');
            connections.forEach(conn => {
                conn.classList.remove('active', 'strong');
            });
            
            // Reinitialize weights
            neuralNetwork.weights.input_hidden1 = generateWeightMatrix(3, 6);
            neuralNetwork.weights.hidden1_hidden2 = generateWeightMatrix(6, 4);
            neuralNetwork.weights.hidden2_output = generateWeightMatrix(4, 3);
            
            updateWeightDisplayMobile();
            updateNeuralStats();
            addNeuralLog('[NEURAL-RESET] Neur√°lis h√°l√≥ √∫jraind√≠tva', '#ff8800');
            addAlarm('info', 'Neur√°lis h√°l√≥ reset befejezve', getCurrentTime());
            showMobileNotification('üîÑ Neur√°lis h√°l√≥ resetelve', 'info');
        }

        function updatePIDModal() {
            // Update global PID parameters
            const elements = {
                'modal-pid-kp-mobile': aiController.kp.toFixed(3),
                'modal-pid-ki-mobile': aiController.ki.toFixed(4),
                'modal-pid-kd-mobile': aiController.kd.toFixed(3),
                'modal-pid-performance-mobile': (aiController.performance * 100).toFixed(1) + '%',
                'modal-temp-error-mobile': aiController.tempError.toFixed(2) + '¬∞C',
                'modal-temp-integral-mobile': aiController.tempIntegral.toFixed(2),
                'modal-temp-derivative-mobile': (aiController.tempError - aiController.tempErrorPrev).toFixed(3)
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        function updateNeuralStats() {
            const elements = {
                'active-connections-mobile': `${Math.floor(24 + Math.random() * 6)}/42`,
                'learning-rate-mobile': neuralNetwork.learningRate.toFixed(6),
                'error-function-mobile': neuralNetwork.error.toFixed(6),
                'epoch-count-mobile': neuralNetwork.epochs.toString(),
                'convergence-mobile': neuralNetwork.convergence.toFixed(1) + '%',
                'prediction-accuracy-mobile': (95 + Math.random() * 4).toFixed(1) + '%'
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        // AI Functions
        function toggleAILearning() {
            aiLearningActive = !aiLearningActive;
            
            const elements = ['ai-learn-btn-mobile', 'ai-learning-status'];
            elements.forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    if (aiLearningActive) {
                        btn.textContent = id.includes('status') ? 'AKT√çV' : 'TANUL√ÅS AKT√çV';
                        btn.className = btn.className.replace('danger', 'success');
                        if (!btn.className.includes('success')) btn.className += ' success';
                    } else {
                        btn.textContent = id.includes('status') ? 'LE√ÅLL√çTVA' : 'TANUL√ÅS LE√ÅLL√çTVA';
                        btn.className = btn.className.replace('success', 'danger');
                        if (!btn.className.includes('danger')) btn.className += ' danger';
                    }
                }
            });
            
            addNeuralLog(`[AI-LEARN] Tanul√°s ${aiLearningActive ? 'bekapcsolva' : 'le√°ll√≠tva'}`, aiLearningActive ? '#00ff00' : '#ff8800');
            addAlarm('info', `AI tanul√°s: ${aiLearningActive ? 'AKT√çV' : 'LE√ÅLL√çTVA'}`, getCurrentTime());
        }

        function tunePID() {
            // Simulate PID tuning
            aiController.kp += (Math.random() - 0.5) * 0.1;
            aiController.ki += (Math.random() - 0.5) * 0.02;
            aiController.kd += (Math.random() - 0.5) * 0.05;
            
            // Keep within reasonable bounds
            aiController.kp = Math.max(0.5, Math.min(3.0, aiController.kp));
            aiController.ki = Math.max(0.05, Math.min(0.5, aiController.ki));
            aiController.kd = Math.max(0.1, Math.min(1.0, aiController.kd));
            
            aiController.performance = Math.min(0.99, aiController.performance + (Math.random() * 0.02));
            
            updateAllPIDDisplays();
            addNeuralLog(`[PID-TUNE] Kp=${aiController.kp.toFixed(3)} Ki=${aiController.ki.toFixed(4)} Kd=${aiController.kd.toFixed(3)}`, '#ffff00');
            addAlarm('info', 'PID param√©terek automatikus hangol√°sa befejezve', getCurrentTime());
        }

        function resetAI() {
            aiController.iterations = 0;
            aiController.kp = 1.2;
            aiController.ki = 0.15;
            aiController.kd = 0.25;
            aiController.performance = 0.95;
            
            // Reset PID state variables
            aiController.tempError = 0;
            aiController.tempErrorPrev = 0;
            aiController.tempIntegral = 0;
            aiController.pressureError = 0;
            aiController.pressureErrorPrev = 0;
            aiController.pressureIntegral = 0;
            aiController.flowError = 0;
            aiController.flowErrorPrev = 0;
            aiController.flowIntegral = 0;
            
            updateAllPIDDisplays();
            addNeuralLog('[AI-RESET] AI rendszer √©s PID √°llapot √∫jraind√≠tva', '#ffff00');
            addAlarm('info', 'AI-PID szab√°lyoz√≥ reset', getCurrentTime());
        }

        function changeAIMode() {
            const select = document.getElementById('ai-mode-mobile');
            if (select) {
                aiController.mode = select.value;
                addNeuralLog(`[AI-MODE] V√°lt√°s: ${select.value}`, '#ffff00');
                addAlarm('info', `AI m√≥d v√°lt√°s: ${select.value}`, getCurrentTime());
            }
        }

        function simulateTraining() {
            neuralNetwork.epochs += Math.floor(10 + Math.random() * 20);
            neuralNetwork.error = Math.max(0.0001, neuralNetwork.error * (0.98 + Math.random() * 0.03));
            neuralNetwork.convergence = Math.min(99.9, neuralNetwork.convergence + Math.random() * 0.5);
            
            updateNeuralStats();
            addNeuralLog(`[NEURAL-TRAIN] Epoch ${neuralNetwork.epochs}, Hiba: ${neuralNetwork.error.toFixed(6)}`, '#ffff00');
            addAlarm('info', `Neur√°lis h√°l√≥ tan√≠t√°s: Epoch ${neuralNetwork.epochs}`, getCurrentTime());
        }

        function resetNeuralNetwork() {
            neuralNetwork.epochs = 0;
            neuralNetwork.error = 0.1;
            neuralNetwork.convergence = 50.0;
            
            updateNeuralStats();
            addNeuralLog('[NEURAL-RESET] Neur√°lis h√°l√≥ √∫jraind√≠tva', '#ff8800');
            addAlarm('info', 'Neur√°lis h√°l√≥ reset befejezve', getCurrentTime());
        }

        function exportNeuralData() {
            const neuralData = {
                architecture: "3-6-4-3",
                stats: {
                    epochs: neuralNetwork.epochs,
                    error: neuralNetwork.error,
                    convergence: neuralNetwork.convergence,
                    learningRate: neuralNetwork.learningRate
                },
                timestamp: new Date().toISOString()
            };
            
            addNeuralLog('[NEURAL-EXPORT] Neur√°lis h√°l√≥ adatok export√°lva', '#00ff00');
            addAlarm('info', 'Neur√°lis h√°l√≥ adatok sikeresen export√°lva', getCurrentTime());
            
            // Mobile-friendly export notification
            showMobileNotification('üíæ Neur√°lis h√°l√≥ adatok export√°lva', 'success');
        }

        // Setpoint Functions
        function updateSetpoint(type) {
            let inputId = type + '-setpoint-mobile';
            let oldValue, newValue, unit, tag;
            
            switch(type) {
                case 'temp':
                    oldValue = processData.tempSetpoint;
                    newValue = parseFloat(document.getElementById(inputId).value);
                    processData.tempSetpoint = newValue;
                    unit = '¬∞C';
                    tag = 'TIC-101';
                    break;
                case 'pressure':
                    oldValue = processData.pressureSetpoint;
                    newValue = parseFloat(document.getElementById(inputId).value);
                    processData.pressureSetpoint = newValue;
                    unit = ' bar';
                    tag = 'PIC-201';
                    break;
                case 'flow':
                    oldValue = processData.flowSetpoint;
                    newValue = parseFloat(document.getElementById(inputId).value);
                    processData.flowSetpoint = newValue;
                    unit = ' L/min';
                    tag = 'FIC-301';
                    break;
            }
            
            updateSetpointStatus(type, newValue);
            updateDataViewSetpoints();
            
            addNeuralLog(`[SETPOINT] ${tag}: ${oldValue}${unit} ‚Üí ${newValue}${unit}`, '#00ffff');
            addAlarm('info', `Setpoint m√≥dos√≠tva: ${tag} = ${newValue}${unit}`, getCurrentTime());
            
            // Visual feedback
            const input = document.getElementById(inputId);
            if (input) {
                input.style.borderColor = 'var(--success-green)';
                input.style.boxShadow = '0 0 5px rgba(34, 197, 94, 0.3)';
                setTimeout(() => {
                    input.style.borderColor = 'var(--border-color)';
                    input.style.boxShadow = 'none';
                }, 1000);
            }
            
            showMobileNotification(`üéØ ${tag} be√°ll√≠tva: ${newValue}${unit}`, 'success');
        }

        function previewSetpoint(type) {
            const inputId = type + '-setpoint-mobile';
            const input = document.getElementById(inputId);
            const value = parseFloat(input.value);
            
            updateSetpointStatus(type, value, true);
        }

        function updateSetpointStatus(type, value, preview = false) {
            const statusElementId = type + '-status-mobile';
            const statusElement = document.getElementById(statusElementId);
            if (!statusElement) return;
            
            let status = 'OK';
            let color = 'var(--status-green)';
            
            switch(type) {
                case 'temp':
                    if (value < 20 || value > 100) {
                        status = 'TARTOM√ÅNYON K√çV√úL';
                        color = 'var(--danger-red)';
                    } else if (value > 80) {
                        status = 'MAGAS';
                        color = 'var(--warning-yellow)';
                    } else if (value < 30) {
                        status = 'ALACSONY';
                        color = 'var(--warning-yellow)';
                    }
                    break;
                case 'pressure':
                    if (value < 0 || value > 15) {
                        status = 'TARTOM√ÅNYON K√çV√úL';
                        color = 'var(--danger-red)';
                    } else if (value > 10) {
                        status = 'MAGAS';
                        color = 'var(--warning-yellow)';
                    } else if (value < 1) {
                        status = 'ALACSONY';
                        color = 'var(--warning-yellow)';
                    }
                    break;
                case 'flow':
                    if (value < 0 || value > 10) {
                        status = 'TARTOM√ÅNYON K√çV√úL';
                        color = 'var(--danger-red)';
                    } else if (value > 8) {
                        status = 'MAGAS';
                        color = 'var(--warning-yellow)';
                    } else if (value < 0.5) {
                        status = 'ALACSONY';
                        color = 'var(--warning-yellow)';
                    }
                    break;
            }
            
            statusElement.textContent = preview ? `${status} (el≈ën√©zet)` : status;
            statusElement.style.color = color;
            
            // Update status indicator
            const statusIndicator = statusElement.parentElement.querySelector('.status-indicator');
            if (statusIndicator) {
                statusIndicator.className = 'status-indicator ' + 
                    (color === 'var(--status-green)' ? 'status-ok' : 
                     color === 'var(--warning-yellow)' ? 'status-warning' : 'status-error');
            }
        }

        function setQuickSetpoints(mode) {
            let tempSP, pressureSP, flowSP;
            
            switch(mode) {
                case 'normal':
                    tempSP = 65.0;
                    pressureSP = 5.0;
                    flowSP = 3.0;
                    addNeuralLog('[QUICK-SET] Norm√°l √ºzemm√≥d be√°ll√≠tva', '#00ffff');
                    break;
                case 'high':
                    tempSP = 75.0;
                    pressureSP = 7.5;
                    flowSP = 4.5;
                    addNeuralLog('[QUICK-SET] Magas teljes√≠tm√©ny be√°ll√≠tva', '#ffff00');
                    break;
                case 'low':
                    tempSP = 45.0;
                    pressureSP = 3.0;
                    flowSP = 1.5;
                    addNeuralLog('[QUICK-SET] Alacsony teljes√≠tm√©ny be√°ll√≠tva', '#00ffff');
                    break;
                case 'emergency':
                    tempSP = 25.0;
                    pressureSP = 1.0;
                    flowSP = 0.5;
                    addNeuralLog('[QUICK-SET] V√âSZHELYZETI le√°ll√≠t√°s be√°ll√≠tva', '#ff0000');
                    addAlarm('warning', 'V√©szhelyzeti setpoint-ok aktiv√°lva', getCurrentTime());
                    break;
            }
            
            document.getElementById('temp-setpoint-mobile').value = tempSP;
            document.getElementById('pressure-setpoint-mobile').value = pressureSP;
            document.getElementById('flow-setpoint-mobile').value = flowSP;
            
            processData.tempSetpoint = tempSP;
            processData.pressureSetpoint = pressureSP;
            processData.flowSetpoint = flowSP;
            
            updateSetpointStatus('temp', tempSP);
            updateSetpointStatus('pressure', pressureSP);
            updateSetpointStatus('flow', flowSP);
            updateDataViewSetpoints();
            
            showMobileNotification(`‚ö° ${mode.toUpperCase()} be√°ll√≠t√°s alkalmazva`, mode === 'emergency' ? 'error' : 'success');
            addAlarm('info', `Gyors be√°ll√≠t√°s alkalmazva: ${mode.toUpperCase()}`, getCurrentTime());
        }

        // Equipment and Sensor Functions
        function showEquipmentInfo(equipment) {
            const equipmentNames = {
                'reactor': 'R-001 Reaktor',
                'hx': 'HX-001 H≈ëcser√©l≈ë',
                'pump': 'P-001 Pumpa',
                'valve': 'V-001 Szelep',
                'tank': 'T-001 Tank'
            };
            
            addNeuralLog(`[EQUIPMENT] ${equipmentNames[equipment]} inform√°ci√≥ megjelen√≠tve`, '#00ffff');
            
            const info = `${equipmentNames[equipment]} Inform√°ci√≥:
            
√Ållapot: M≈±k√∂dik
Hat√©konys√°g: 95%
Utols√≥ karbantart√°s: 2024-05-15
K√∂vetkez≈ë karbantart√°s: 2024-08-15`;
            
            showMobileModal('üè≠ Berendez√©s Info', info);
        }

        function showSensorInfo(sensorId) {
            const sensorData = {
                'TI-101': { value: processData.reactorTemp, unit: '¬∞C', name: 'Reaktor H≈ëm√©rs√©klet' },
                'TI-102': { value: processData.hxOutletTemp, unit: '¬∞C', name: 'H≈ëcser√©l≈ë Kimenet' },
                'PI-201': { value: processData.reactorPressure, unit: ' bar', name: 'Reaktor Nyom√°s' },
                'PI-202': { value: processData.linePressure, unit: ' bar', name: 'Vezet√©k Nyom√°s' },
                'FI-301': { value: processData.mainFlow, unit: ' L/min', name: 'F≈ë √Åraml√°s' }
            };
            
            const sensor = sensorData[sensorId];
            if (sensor) {
                addNeuralLog(`[SENSOR] ${sensorId} inform√°ci√≥ megjelen√≠tve`, '#00ffff');
                
                const info = `${sensorId} - ${sensor.name}
                
Aktu√°lis √©rt√©k: ${sensor.value.toFixed(2)}${sensor.unit}
M√©r√©si tartom√°ny: 0-200${sensor.unit}
Pontoss√°g: ¬±0.1${sensor.unit}
Utols√≥ kalibr√°l√°s: 2024-04-15
K√∂vetkez≈ë kalibr√°l√°s: 2024-10-15
Senzor √°llapot: OK`;
                
                showMobileModal('üìä Szenzor Info', info);
            }
        }

        // System Functions
        function toggleMaintenance() {
            maintenanceMode = !maintenanceMode;
            
            if (maintenanceMode) {
                addNeuralLog('[MAINTENANCE] Karbantart√°si m√≥d AKT√çV', '#ff8800');
                addAlarm('warning', 'Karbantart√°si m√≥d aktiv√°lva', getCurrentTime());
                showMobileNotification('üîß Karbantart√°si m√≥d AKT√çV', 'warning');
            } else {
                addNeuralLog('[MAINTENANCE] Karbantart√°si m√≥d INAKT√çV', '#00ffff');
                addAlarm('info', 'Karbantart√°si m√≥d kikapcsolva', getCurrentTime());
                showMobileNotification('üîß Karbantart√°si m√≥d KIKAPCSOLVA', 'info');
            }
        }

        function exportReport() {
            addNeuralLog('[EXPORT] Jelent√©s gener√°l√°s ind√≠tva...', '#ffff00');
            
            const reportContent = `SCADA/DCS MOBILE REPORT
Generated: ${new Date().toLocaleString('hu-HU')}
==============================================

PROCESS STATUS:
- Reactor Temperature: ${processData.reactorTemp.toFixed(2)}¬∞C (SP: ${processData.tempSetpoint}¬∞C)
- Reactor Pressure: ${processData.reactorPressure.toFixed(2)} bar (SP: ${processData.pressureSetpoint} bar)
- Main Flow: ${processData.mainFlow.toFixed(2)} L/min (SP: ${processData.flowSetpoint} L/min)

AI-PID CONTROLLER:
- Mode: ${aiController.mode}
- Learning: ${aiLearningActive ? 'ACTIVE' : 'INACTIVE'}
- Performance: ${(aiController.performance * 100).toFixed(1)}%
- Kp: ${aiController.kp.toFixed(3)}
- Ki: ${aiController.ki.toFixed(4)}
- Kd: ${aiController.kd.toFixed(3)}

NEURAL NETWORK:
- Architecture: 3-6-4-3
- Epochs: ${neuralNetwork.epochs}
- Error: ${neuralNetwork.error.toFixed(6)}
- Convergence: ${neuralNetwork.convergence.toFixed(1)}%

SYSTEM STATUS:
- Active Alarms: ${alarmCount}
- Maintenance Mode: ${maintenanceMode ? 'ACTIVE' : 'INACTIVE'}
- Current View: ${currentView}
- Report ID: RPT-${Date.now()}`;
            
            showMobileModal('üìã Rendszer Jelent√©s', reportContent, true);
            addNeuralLog('[EXPORT] Jelent√©s gener√°lva', '#00ff00');
            addAlarm('info', 'Rendszer jelent√©s gener√°lva', getCurrentTime());
        }

        // Alarm Functions
        function acknowledgeAlarms() {
            const alarms = document.querySelectorAll('.alarm-entry');
            alarms.forEach(alarm => {
                alarm.style.opacity = '0.6';
                alarm.style.background = 'rgba(100, 116, 139, 0.2)';
            });
            
            addNeuralLog('[ALARM] Riaszt√°sok nyugt√°zva', '#00ffff');
            showMobileNotification('‚úì Riaszt√°sok nyugt√°zva', 'success');
            
            const alarmIndicator = document.getElementById('alarm-status');
            if (alarmIndicator) {
                alarmIndicator.className = 'alarm-indicator touchable';
            }
        }

        function clearAlarms() {
            const alarmsList = document.getElementById('alarms-list-mobile');
            if (alarmsList) {
                alarmsList.innerHTML = '';
            }
            alarmCount = 0;
            updateAlarmDisplay();
            addNeuralLog('[ALARM] Riaszt√°sok t√∂r√∂lve', '#00ffff');
            showMobileNotification('üóëÔ∏è Riaszt√°sok t√∂r√∂lve', 'info');
        }

        function printAlarms() {
            addNeuralLog('[PRINT] Riaszt√°s lista nyomtat√°sa', '#00ffff');
            showMobileNotification('üñ®Ô∏è Nyomtat√°s ind√≠tva', 'info');
            // Mobile-friendly print would typically open a share dialog
            if (navigator.share) {
                navigator.share({
                    title: 'SCADA Riaszt√°sok',
                    text: 'SCADA/DCS rendszer riaszt√°sok'
                });
            } else {
                window.print();
            }
        }

        function updateTrendTimespan() {
            const select = document.getElementById('trend-timespan-mobile');
            if (select) {
                const minutes = select.value;
                addNeuralLog(`[TREND] Id≈ëtartam be√°ll√≠tva: ${minutes} perc`, '#00ffff');
                showMobileNotification(`üìä Trend id≈ëtartam: ${minutes} perc`, 'info');
            }
        }

        // Helper Functions
        function getCurrentTime() {
            return new Date().toLocaleTimeString('hu-HU', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function addNeuralLog(message, color = '#00ff00') {
            const log = document.getElementById('neural-log');
            if (log) {
                const div = document.createElement('div');
                div.style.color = color;
                div.textContent = `[${getCurrentTime()}] ${message}`;
                log.appendChild(div);
                log.scrollTop = log.scrollHeight;
                
                while (log.children.length > 15) {
                    log.removeChild(log.firstChild);
                }
            }
        }

        function addAlarm(severity, message, time) {
            const alarmsList = document.getElementById('alarms-list-mobile');
            if (alarmsList) {
                const alarmEntry = document.createElement('div');
                alarmEntry.className = `alarm-entry ${severity}`;
                alarmEntry.innerHTML = `
                    <span class="alarm-time">${time}</span>
                    <span class="alarm-message">${message}</span>
                `;
                
                alarmsList.insertBefore(alarmEntry, alarmsList.firstChild);
                
                while (alarmsList.children.length > 20) {
                    alarmsList.removeChild(alarmsList.lastChild);
                }
                
                alarmCount++;
                updateAlarmDisplay();
            }
        }

        function updateAlarmDisplay() {
            const alarmCountElement = document.getElementById('alarm-count');
            const alarmStatus = document.getElementById('alarm-status');
            const totalAlarmsElement = document.getElementById('total-alarms');
            
            if (alarmCountElement) {
                alarmCountElement.textContent = alarmCount;
            }
            
            if (totalAlarmsElement) {
                totalAlarmsElement.textContent = alarmCount;
            }
            
            if (alarmStatus) {
                if (alarmCount === 0) {
                    alarmStatus.className = 'alarm-indicator touchable';
                } else if (alarmCount < 5) {
                    alarmStatus.className = 'alarm-indicator warning touchable';
                } else {
                    alarmStatus.className = 'alarm-indicator critical touchable';
                }
            }
        }

        function updateSystemTime() {
            const timeElement = document.getElementById('system-time');
            if (timeElement) {
                const now = new Date();
                const timeString = now.toLocaleTimeString('hu-HU', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                timeElement.textContent = timeString;
            }
        }

        function updateProcessData() {
            // Simulate PID control
            pidControlTemperature();
            pidControlPressure();
            pidControlFlow();
            
            // Add some random variation
            processData.reactorTemp += (Math.random() - 0.5) * 0.1;
            processData.hxOutletTemp = processData.reactorTemp - 20 + (Math.random() - 0.5) * 2;
            processData.tankTemp = processData.hxOutletTemp - 5 + (Math.random() - 0.5) * 1;
            processData.reactorPressure += (Math.random() - 0.5) * 0.05;
            processData.linePressure = processData.reactorPressure - 0.3 + (Math.random() - 0.5) * 0.1;
            processData.mainFlow += (Math.random() - 0.5) * 0.05;
            processData.bypassFlow = processData.mainFlow * 0.6 + (Math.random() - 0.5) * 0.1;
            
            // Update all displays
            updateAllDataDisplays();
            checkAlarms();
        }

        function updateAllDataDisplays() {
            // Update data view
            const dataElements = {
                'data-ti101': processData.reactorTemp.toFixed(1) + '¬∞C',
                'data-ti102': processData.hxOutletTemp.toFixed(1) + '¬∞C',
                'data-ti103': processData.tankTemp.toFixed(1) + '¬∞C',
                'data-pi201': processData.reactorPressure.toFixed(1) + ' bar',
                'data-pi202': processData.linePressure.toFixed(1) + ' bar',
                'data-fi301': processData.mainFlow.toFixed(1) + ' L/min',
                'data-fi302': processData.bypassFlow.toFixed(1) + ' L/min'
            };
            
            Object.entries(dataElements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
            
            // Update P&ID style process displays
            const pidDisplays = {
                'display-temp1': processData.reactorTemp.toFixed(1) + '¬∞C',
                'display-temp2': processData.hxOutletTemp.toFixed(1) + '¬∞C',
                'display-pressure1': processData.reactorPressure.toFixed(1) + ' bar',
                'display-flow1': processData.mainFlow.toFixed(1) + ' L/min'
            };
            
            Object.entries(pidDisplays).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    const valueElement = element.querySelector('.display-value');
                    if (valueElement) valueElement.textContent = value;
                }
            });
            
            // Update legacy process variables for compatibility
            const pvElements = {
                'pv-temp1': processData.reactorTemp.toFixed(1) + '¬∞C',
                'pv-temp2': processData.hxOutletTemp.toFixed(1) + '¬∞C',
                'pv-flow1': processData.mainFlow.toFixed(1) + ' L/min'
            };
            
            Object.entries(pvElements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
            
            updateDataViewSetpoints();
            updateAllPIDDisplays();
        }

        function updateDataViewSetpoints() {
            const setpointElements = {
                'data-temp-sp': processData.tempSetpoint.toFixed(1) + '¬∞C',
                'data-pressure-sp': processData.pressureSetpoint.toFixed(1) + ' bar',
                'data-flow-sp': processData.flowSetpoint.toFixed(1) + ' L/min'
            };
            
            Object.entries(setpointElements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        function updateAllPIDDisplays() {
            const pidElements = {
                'data-kp': aiController.kp.toFixed(3),
                'data-ki': aiController.ki.toFixed(4),
                'data-kd': aiController.kd.toFixed(3),
                'data-performance': (aiController.performance * 100).toFixed(1) + '%'
            };
            
            Object.entries(pidElements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) element.textContent = value;
            });
        }

        // PID Control Functions
        function pidControlTemperature() {
            aiController.tempError = processData.tempSetpoint - processData.reactorTemp;
            
            const P = aiController.kp * aiController.tempError;
            
            aiController.tempIntegral += aiController.tempError;
            if (aiController.tempIntegral > 100) aiController.tempIntegral = 100;
            if (aiController.tempIntegral < -100) aiController.tempIntegral = -100;
            const I = aiController.ki * aiController.tempIntegral;
            
            const D = aiController.kd * (aiController.tempError - aiController.tempErrorPrev);
            
            const output = P + I + D;
            const controlAction = output * 0.1;
            processData.reactorTemp += controlAction;
            
            aiController.tempErrorPrev = aiController.tempError;
        }

        function pidControlPressure() {
            aiController.pressureError = processData.pressureSetpoint - processData.reactorPressure;
            
            const P = aiController.kp * 0.8 * aiController.pressureError;
            
            aiController.pressureIntegral += aiController.pressureError;
            if (aiController.pressureIntegral > 50) aiController.pressureIntegral = 50;
            if (aiController.pressureIntegral < -50) aiController.pressureIntegral = -50;
            const I = aiController.ki * 0.5 * aiController.pressureIntegral;
            
            const D = aiController.kd * 0.3 * (aiController.pressureError - aiController.pressureErrorPrev);
            
            const output = P + I + D;
            const controlAction = output * 0.05;
            processData.reactorPressure += controlAction;
            
            aiController.pressureErrorPrev = aiController.pressureError;
        }

        function pidControlFlow() {
            aiController.flowError = processData.flowSetpoint - processData.mainFlow;
            
            const P = aiController.kp * 0.6 * aiController.flowError;
            
            aiController.flowIntegral += aiController.flowError;
            if (aiController.flowIntegral > 30) aiController.flowIntegral = 30;
            if (aiController.flowIntegral < -30) aiController.flowIntegral = -30;
            const I = aiController.ki * 0.3 * aiController.flowIntegral;
            
            const D = aiController.kd * 0.4 * (aiController.flowError - aiController.flowErrorPrev);
            
            const output = P + I + D;
            const controlAction = output * 0.08;
            processData.mainFlow += controlAction;
            
            aiController.flowErrorPrev = aiController.flowError;
        }

        function checkAlarms() {
            if (processData.reactorTemp > 70) {
                addAlarm('critical', `Magas h≈ëm√©rs√©klet riaszt√°s - TI-101: ${processData.reactorTemp.toFixed(1)}¬∞C`, getCurrentTime());
            }
            
            if (processData.reactorPressure > 8) {
                addAlarm('critical', `Magas nyom√°s riaszt√°s - PI-201: ${processData.reactorPressure.toFixed(1)} bar`, getCurrentTime());
            }
            
            if (processData.mainFlow < 2) {
                addAlarm('warning', `Alacsony √°raml√°s - FI-301: ${processData.mainFlow.toFixed(1)} L/min`, getCurrentTime());
            }
        }

        // Mobile-specific UI Functions
        function showMobileNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 70px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'success' ? 'var(--success-green)' : 
                           type === 'warning' ? 'var(--warning-yellow)' : 
                           type === 'error' ? 'var(--danger-red)' : 'var(--secondary-blue)'};
                color: ${type === 'warning' ? 'black' : 'white'};
                padding: 10px 20px;
                border-radius: 6px;
                font-size: 12px;
                font-weight: bold;
                z-index: 3000;
                max-width: 90vw;
                text-align: center;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                animation: slideDown 0.3s ease;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideUp 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        function showMobileModal(title, content, monospace = false) {
            const existingModal = document.getElementById('mobile-info-modal');
            if (existingModal) {
                existingModal.remove();
            }
            
            const modal = document.createElement('div');
            modal.id = 'mobile-info-modal';
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 3000; display: flex;
                align-items: center; justify-content: center; padding: 20px;
                animation: fadeIn 0.3s ease;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: var(--panel-bg); border: 2px solid var(--secondary-blue); 
                border-radius: 12px; padding: 0; max-width: 90vw; max-height: 80vh; 
                overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                animation: slideIn 0.3s ease;
            `;
            
            modalContent.innerHTML = `
                <div style="background: linear-gradient(135deg, var(--secondary-blue), var(--primary-blue)); 
                           color: white; padding: 12px 15px; border-radius: 10px 10px 0 0; 
                           display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="margin: 0; font-size: 14px;">${title}</h3>
                    <button style="background: none; border: none; color: white; font-size: 18px; 
                                   cursor: pointer; padding: 5px; min-width: 30px; min-height: 30px;" 
                            onclick="this.closest('#mobile-info-modal').remove()">‚úï</button>
                </div>
                <div style="padding: 15px;">
                    <pre style="background: var(--scada-bg); padding: 12px; border-radius: 4px; 
                              font-size: ${monospace ? '9px' : '11px'}; line-height: 1.4; 
                              color: ${monospace ? 'var(--status-green)' : 'var(--text-primary)'}; 
                              border: 1px solid var(--border-color); margin: 0; 
                              white-space: pre-wrap; font-family: ${monospace ? "'Courier New', monospace" : "Arial, sans-serif"};">${content}</pre>
                    <div style="text-align: center; margin-top: 15px;">
                        <button style="padding: 8px 16px; background: var(--secondary-blue); color: white; 
                                       border: none; border-radius: 4px; cursor: pointer; font-weight: bold;"
                                onclick="this.closest('#mobile-info-modal').remove()">‚úÖ Bez√°r√°s</button>
                    </div>
                </div>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            modal.onclick = function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            };
        }

        // Chart initialization for mobile
        function initializeCharts() {
            const tempCtx = document.getElementById('temp-trend-mobile');
            if (tempCtx && !tempTrendChart) {
                tempTrendChart = new Chart(tempCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'TI-101 Reaktor',
                            data: [],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 2,
                            tension: 0.4
                        }, {
                            label: 'C√©l√©rt√©k',
                            data: [],
                            borderColor: '#22c55e',
                            borderDash: [3, 3],
                            borderWidth: 1,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: '#f1f5f9', font: { size: 9 } }
                            }
                        },
                        scales: {
                            x: { display: false },
                            y: {
                                grid: { color: '#334155' },
                                ticks: { color: '#94a3b8', font: { size: 8 } },
                                title: {
                                    display: true,
                                    text: '¬∞C',
                                    color: '#94a3b8',
                                    font: { size: 9 }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }

            const pressureCtx = document.getElementById('pressure-trend-mobile');
            if (pressureCtx && !pressureTrendChart) {
                pressureTrendChart = new Chart(pressureCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'PI-201 Reaktor',
                            data: [],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            tension: 0.4
                        }, {
                            label: 'C√©l√©rt√©k',
                            data: [],
                            borderColor: '#22c55e',
                            borderDash: [3, 3],
                            borderWidth: 1,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: '#f1f5f9', font: { size: 9 } }
                            }
                        },
                        scales: {
                            x: { display: false },
                            y: {
                                grid: { color: '#334155' },
                                ticks: { color: '#94a3b8', font: { size: 8 } },
                                title: {
                                    display: true,
                                    text: 'bar',
                                    color: '#94a3b8',
                                    font: { size: 9 }
                                }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }

            const pidCtx = document.getElementById('pid-trend-mobile');
            if (pidCtx && !pidTrendChart) {
                pidTrendChart = new Chart(pidCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Kp',
                            data: [],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            yAxisID: 'y'
                        }, {
                            label: 'Ki√ó10',
                            data: [],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            yAxisID: 'y'
                        }, {
                            label: 'Kd',
                            data: [],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            yAxisID: 'y'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { color: '#f1f5f9', font: { size: 8 } }
                            }
                        },
                        scales: {
                            x: { display: false },
                            y: {
                                grid: { color: '#334155' },
                                ticks: { color: '#94a3b8', font: { size: 8 } }
                            }
                        },
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        }
                    }
                });
            }
        }

        function updateCharts() {
            const now = new Date();
            const timeLabel = now.toLocaleTimeString('hu-HU', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            if (tempTrendChart) {
                tempTrendChart.data.labels.push(timeLabel);
                tempTrendChart.data.datasets[0].data.push(processData.reactorTemp);
                tempTrendChart.data.datasets[1].data.push(processData.tempSetpoint);
                
                if (tempTrendChart.data.labels.length > 20) {
                    tempTrendChart.data.labels.shift();
                    tempTrendChart.data.datasets[0].data.shift();
                    tempTrendChart.data.datasets[1].data.shift();
                }
                
                tempTrendChart.update('none');
            }
            
            if (pressureTrendChart) {
                pressureTrendChart.data.labels.push(timeLabel);
                pressureTrendChart.data.datasets[0].data.push(processData.reactorPressure);
                pressureTrendChart.data.datasets[1].data.push(processData.pressureSetpoint);
                
                if (pressureTrendChart.data.labels.length > 20) {
                    pressureTrendChart.data.labels.shift();
                    pressureTrendChart.data.datasets[0].data.shift();
                    pressureTrendChart.data.datasets[1].data.shift();
                }
                
                pressureTrendChart.update('none');
            }
            
            if (pidTrendChart) {
                pidTrendChart.data.labels.push(timeLabel);
                pidTrendChart.data.datasets[0].data.push(aiController.kp);
                pidTrendChart.data.datasets[1].data.push(aiController.ki * 10);
                pidTrendChart.data.datasets[2].data.push(aiController.kd);
                
                if (pidTrendChart.data.labels.length > 20) {
                    pidTrendChart.data.labels.shift();
                    pidTrendChart.data.datasets[0].data.shift();
                    pidTrendChart.data.datasets[1].data.shift();
                    pidTrendChart.data.datasets[2].data.shift();
                }
                
                pidTrendChart.update('none');
            }
        }

        // Add CSS animations for mobile notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideDown {
                from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
                to { transform: translateX(-50%) translateY(0); opacity: 1; }
            }
            @keyframes slideUp {
                from { transform: translateX(-50%) translateY(0); opacity: 1; }
                to { transform: translateX(-50%) translateY(-100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialize system when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateSystemTime();
            setInterval(updateSystemTime, 1000);
            
            setInterval(updateProcessData, 2000);
            setInterval(updateCharts, 5000);
            
            setInterval(() => {
                if (aiLearningActive) {
                    aiController.iterations++;
                    neuralNetwork.epochs++;
                    
                    if (aiController.iterations % 100 === 0) {
                        aiController.performance = Math.min(0.99, aiController.performance + 0.001);
                        neuralNetwork.error = Math.max(0.0001, neuralNetwork.error * 0.999);
                        neuralNetwork.convergence = Math.min(99.9, neuralNetwork.convergence + 0.01);
                    }
                    
                    if (aiController.iterations % 50 === 0) {
                        addNeuralLog(`[AI-ITER] Tanul√°si iter√°ci√≥: ${aiController.iterations}`, '#ffff00');
                    }
                }
                
                const pidModal = document.getElementById('pid-modal-overlay-mobile');
                if (pidModal && pidModal.classList.contains('show')) {
                    updatePIDModal();
                }
                
                const neuralModal = document.getElementById('neural-modal-overlay-mobile');
                if (neuralModal && neuralModal.classList.contains('show')) {
                    updateNeuralStats();
                }
            }, 1000);
            
            setTimeout(() => {
                updateAllDataDisplays();
            }, 100);
            
            addNeuralLog('[SYSTEM] SCADA/DCS Mobile rendszer inicializ√°lva', '#00ff00');
            addNeuralLog('[AI-PID] Neur√°lis h√°l√≥ akt√≠v', '#ffff00');
            addNeuralLog('[MOBILE] Touch-optimaliz√°lt interf√©sz bet√∂ltve', '#00ffff');
            showMobileNotification('üè≠ SCADA/DCS Mobile rendszer k√©sz', 'success');
        });

        // Prevent zoom on double-tap for better mobile experience
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Handle orientation change
        window.addEventListener('orientationchange', function() {
            setTimeout(() => {
                if (tempTrendChart) tempTrendChart.resize();
                if (pressureTrendChart) pressureTrendChart.resize();
                if (pidTrendChart) pidTrendChart.resize();
            }, 500);
        });
    </script>
</body>
</html>
